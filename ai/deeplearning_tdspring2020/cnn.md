# CNN

## 概念

### WhyCNN？

为什么CNN对图像有较好的效果呢？

CNN可以过滤掉一些不必要的神经元的链接，因为图像中的像素点往往与周遭的点具有较高的联系。

![image-20200912095741965](.\cnn\image-20200912095741965.png)

池化操作可以有效的减少原数据的大小，但是却不损失信息。

![image-20200912100333239](.\cnn\image-20200912100333239.png)

### CNN的一般结构

完整的CNN网络大致都是先卷积再池化，再卷积再池化（但ALPHAGO的围棋只有卷积没有池化）

![image-20200912100602376](.\cnn\image-20200912100602376.png)

卷积可以提取出来出现在一张图片中不同位置的相同特征。

![image-20200912100715521](.\cnn\image-20200912100715521.png)

### 卷积

以该卷积核为例，当一个特定的卷积核出现时，如下图所示：

卷积后的两个元素具有相同或者相近的数值时，就意味着该着两个元素对应的空间部分，他俩的特征就越接近。

![image-20200912101300600](.\cnn\image-20200912101300600.png)

卷积与全连接层相比，它其实是相当于是全连接层拿掉了“无关连接”后的结果。

![image-20200912101703071](.\cnn\image-20200912101703071.png)

下面这两张图可以更明显的看出全连接层与卷积层的关系。

![image-20200912101904959](.\cnn\image-20200912101904959.png)

![image-20200912101949340](.\cnn\image-20200912101949340.png)

由前文可知，CNN卷积后输出也带有相应的空间位置的信息。

所以某种意义上也可以看成是一个新的“图像”。

卷积神经网络会不断的将“图像”变小，不断的提取高阶的特征。

![image-20200912102435470](.\cnn\image-20200912102435470.png)

### keras的卷积

相应的详细API请看文档。

![image-20200912103647239](.\cnn\image-20200912103647239.png)

注意卷积后的网络的大小。

![image-20200912104532097](.\cnn\image-20200912104532097.png)

### 卷积大小计算方式

具体的计算如图

![fase1245146f](.\cnn\fase1245146f.png)

### CNN学到了什么

实际上，神经网络学到东西可能人类不一样。

如下面九个“马赛克”，神经网络分别对它们判断出了0~9。但这并不是判断错误的结果。

而是确实他们可以使得想对应的分类权重值变得最大的结果。

![image-20200912110708899](.\cnn\image-20200912110708899.png)

但老师做实验，将他们卷积后，这些“马赛克图”隐约之间，却反而有了一些对应数字的形状。

这反而说明了，深度学习往往能学到一些和人常规直觉不一样的东西。

![image-20200912111206439](.\cnn\image-20200912111206439.png)

将实际图片与抽象图片进行结合。通过卷积神经网络可以得到不一样的效果。

![image-20200912111727035](.\cnn\image-20200912111727035.png)

### 其他应用

#### AlphaGo

alphago使用了卷积神经网络，与之前介绍的“卷积+池化”的方式不同，alphago仅仅只使用了卷积。

采用CNN原因显然是局部的相同特征出现在任何位置，都应该具有相同的思考方式。不采用池化应该是围棋本身每个落子都应当具有较大的信息量，不可以随便池化。

![image-20200912112254538](.\cnn\image-20200912112254538.png)

![image-20200912112806885](.\cnn\image-20200912112806885.png)

#### 语音识别

在语音识别中，在频率的方向上做卷积。也能提取到一些特征。

![image-20200912113218760](.\cnn\image-20200912113218760.png)

#### 语义识别

对不同词语之间做卷积，也可以提取到新的特征

![image-20200912113647746](.\cnn\image-20200912113647746.png)

### 更多信息

![image-20200912113909249](.\cnn\image-20200912113909249.png)