# Regression

## 预测宝可梦的战斗力

### STEP1模型

![image-20200831233855350](.\regression\image-20200831233855350.png)

![image-20200831234247210](.\regression\image-20200831234247210.png)

### STEP2损失函数

![image-20200831234950863](.\regression\image-20200831234950863.png)

图中，颜色越接近紫色，LossFunction的数值就越小

![image-20200831235300244](.\regression\image-20200831235300244.png)

### STEP3优化

![image-20200831235613972](.\regression\image-20200831235613972.png)

使用梯度下降

求某点斜率，总体目的是为了让loss变得更小

![image-20200831235924724](.\regression\image-20200831235924724.png)

参数w 更新的表达式，注意这里的**负号**：

**负号**的原因很明显，当求出的梯度为负的时候，说明更大的w可以拥有更小的损失。

反之，梯度求出为正的时候，说明更小的w可以拥有更小的损失

故，此处必须带有负号。

![image-20200901000044457](.\regression\image-20200901000044457.png)

对于两个参数，是类似的

![image-20200901000728234](.\regression\image-20200901000728234.png)

![image-20200901000923079](.\regression\image-20200901000923079.png)

对于线性模型而言，是不存在局部最优解的，求解的结果自然就是全局最优解。

具体求解过程：

![image-20200901001429596](.\regression\image-20200901001429596.png)

我们可以发现，不同的模型，最终能达到的效果也不一样

![image-20200901002115858](.\regression\image-20200901002115858.png)

更高次项的也不一定就能够取得特别突出的优势

![image-20200901002408193](.\regression\image-20200901002408193.png)

比如在4次项的时候，就已经出现了过拟合

![image-20200901002517405](.\regression\image-20200901002517405.png)

这里列出复杂模型与简单模型的损失对比，进而得出过拟合的结论

![image-20200901003936646](.\regression\image-20200901003936646.png)

实际上，这个模型对不同的宝可梦来说，并没有进行针对型的预测，所以所以我们需要重新设计模型

![image-20200901004555202](.\regression\image-20200901004555202.png)

### STEP4重设计模型

![image-20200901004657059](.\regression\image-20200901004657059.png)

当然，我们可以用一个式子来表示它

![image-20200901004914718](.\regression\image-20200901004914718.png)

重新设计模型后，损失比之前的更好

![image-20200901005206907](.\regression\image-20200901005206907.png)

### STEP5进一步优化

我们将宝可梦的所有参数全部代入，将它们全都融入模型之中去。

观察结果，虽然训练集上表现良好，但测试集上表现并不佳

![image-20200901005653949](.\regression\image-20200901005653949.png)

我们在损失函数中，加入权重惩罚。这样就可以让函数更平滑，从而受输入的影响更小。

![image-20200901010026826](.\regression\image-20200901010026826.png)

以下，列出了常用λ对损失的影响：

所以我们需要适当的调整λ的数值

![image-20200901010410334](.\regression\image-20200901010410334.png)