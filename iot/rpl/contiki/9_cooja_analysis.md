# Cooja 数据分析

我们发现在Cooja中，存在着大量需要进行数据分析的地方。
我将会在该篇文档中写下关于这些文档的备注信息。

我们将在该文中，对照源码，进行分析。

`~\tools\collect-view\src\se\sics\contiki\collect\CollectServer.java``
``~\tools\collect-view\src\se\sics\contiki\collect\SensorData.java`

![image-20210322142327832](.\imgs_9\image-20210322142327832.png)

从首页上，我们看出这一共有8个大选项卡。

## Node Control

节点控制，顾名思义，核心作用就是控制节点，目前就是选择一个节点后，可以对它进行数据采集。

[^疑问]: 选择节点的不同，是否会导致采集得到的数据不同？

## Sensor Map 与 Network Graph

在Sensor Map下，你可以看到父子节点之间的这种连接关系，如下图所示。

![image-20210322142759713](.\imgs_9\image-20210322142759713.png)

事实上，当你点开Network Graph后，看到的效果也是完全一样的，所以我也不是非常清楚为什么这需要单独设置两个选项卡。

不难发现蓝色的数值，代表了边的权重值。可以猜测的是，这个权重值，就是ETX。

### ETX度量

ETX度量是指一个节点为了成功地传送一个数据包而预期向目的地进行的传输次数。与LQL路由度量相比，ETX提供了一个根据特定公式计算的离散值(它可能不是整数)：例如，一个实施例可以使用以下公式。ETX= 1 / (Df * Dr)，其中**Df**是<u>邻居收到数据包的测量概率</u>，**Dr**是<u>成功收到确认数据包的测量概率</u>。本文档并没有强制要求使用特定的公式来计算ETX值。
ETX 对象可以存在于 DAG 指标容器中。每个 DAG 指标容器中作为约束条件的 ETX 对象必须不超过一个，每个 DAG 指标容器中作为指标的 ETX 对象必须不超过一个。
**ETX 对象**由 **ETX 子对象**组成，<u>并且必须至少包含一个 ETX 子对象</u>。每个ETX子对象的长度固定为16位。
ETX 对象不包含任何额外的 TLV。ETX 对象的类型已被 IANA 赋予 7 的值。

**ETX 对象**主体的格式如下：
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | (sub-object) .....
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+

**ETX 子对象**的格式如下：

   0                               1
   0 1 2 3  4 5  6 7 8 9  0 1 2  3 4 5
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        ETX                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

ETX：16位。**ETX * 128**使用16位无符号整数格式编码，<u>四舍五入到最接近的整数</u>。例如，如果 ETX = 3.569，则对象值为 457（456.832 = 3.569 * 128）。如果 ETX > 511.9921875，则对象值为最大值，即 65535。
**ETX对象**可以作为约束条件或路径指标使用。例如，可能要求 ETX 不能超过某个指定的值，在这种情况下，ETX 对象可以作为约束条件或路径指标使用。在这种情况下，ETX对象的通用头表示该值与约束有关。
在另一个例子中，ETX对象可以被用作聚合加成度量（aggregated additive metric），其值沿路径更新以反映路径质量。当节点接收到路径的聚合加成ETX值（累积路径ETX计算为从广播节点到DAG根的所有遍历链路的链路ETX之和）时，如果它选择该节点作为它的优选父节点，则节点在可能给自己广告新的路径ETX之前，通过将自己和优选父节点之间的本地链路的ETX加到接收到的路径成本（路径ETX）来更新路径ETX。

## Sensors

传感器下，包含了有众多的子Tab。

1. Battery Indicator & Battery Voltage

   电源指示器，我们发现在任意时刻，几乎绘制都绘制在这条线："indicator == 1"上面。

   indicator在这里具体指的是什么意思？

2. Relative Humidity

   所有的时刻，都绘制在 "humidity == 100%" 这条线上。

3. Light？

   Light在图中是发生了变化的，无论是light1 又或是 light2。
   但Light为什么会发生变化？为什么会发生这样的变化？目前还是不得而知。
   
4. Temperature & Average Temperature

   温度，这个指标也挺离谱的，测得的平均温度指标，都一直在“600Celsius”。

似乎总的来说，这个Sensors下面的这些指标好像没有什么研究的价值啊。

## Network

网络有许许多多的标签，但其中有众多的标签

## Power

Power这个标签下的数据，通过